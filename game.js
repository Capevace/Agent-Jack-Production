/*
	Game Name: Agent Jack "I. Chan" Danger
	Makers: Capevace & LeNerd
	Game type: Fighting Game
*/

JackDanger.AgentJackIEC=function(){},addMyGame("agent-jack-iechan",'Agent Jack "I. Chan"',"TriDev","Packe dicke moves aus und infiltriere die Basis.","Bewegen","Interagieren","Kaempfen",JackDanger.AgentJackIEC),JackDanger.AgentJackIEC.prototype.init=function(){addLoadingScreen(this,!0)},JackDanger.AgentJackIEC.prototype.preload=function(){this.load.path="games/"+currentGameData.id+"/assets/",this.load.image("bg","../assetsraw/ball.png"),this.load.json("maze-scene","scenes/maze-scene.json"),this.load.image("maze-bg","maze-bg.png"),this.load.image("maze-bg-ground","bg/maze-bg-ground.png"),this.load.image("maze-bg-middle","bg/maze-bg-middle.png"),this.load.image("maze-bg-top","bg/maze-bg-top.png"),this.load.atlas("jack","spritesheets/jack.png","spritesheets/jack.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("enemy","spritesheets/enemy.png","spritesheets/enemy.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("scenery","spritesheets/scenery.png","spritesheets/scenery.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("hack-circles","hack/circles.png","hack/circles.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.atlas("blood","spritesheets/blood.png","spritesheets/blood.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH),this.load.audio("jack-hit","sounds/punch-hit.wav"),this.load.audio("jack-nohit","sounds/punch-nohit.wav")},JackDanger.AgentJackIEC.prototype.create=function(){Pad.init()},JackDanger.AgentJackIEC.prototype.mycreate=function(){this.stage.smoothed=!1,this.game.renderer.renderSession.roundPixels=!0,this.currentLevel=this.availableLevels.Maze,this.timeToBeat=0,this.score=0,this.maze=new this.Maze(this),this.boss=new this.Boss(this),this.globalScale=4,this.game.main=this,this.stopped=!1,this.loadLevel(this.availableLevels.Maze)},JackDanger.AgentJackIEC.prototype.update=function(){var t=.001*this.time.physicsElapsedMS;this.stopped||(this.currentLevel==this.availableLevels.Maze?this.maze.update(t):this.currentLevel==this.availableLevels.Boss&&this.boss.update(t))},JackDanger.AgentJackIEC.prototype.render=function(){},JackDanger.AgentJackIEC.prototype.loadLevel=function(t){t==this.availableLevels.Maze?(this.boss.disposeLevel(),this.currentLevel=this.availableLevels.Maze,this.maze.initLevel()):t==this.availableLevels.Boss?(this.maze.disposeLevel(),this.currentLevel=this.availableLevels.Boss,this.boss.initLevel()):logInfo("Dafuq m8. Pass a valid level bitsch")},JackDanger.AgentJackIEC.prototype.stop=function(){this.stopped=!0},JackDanger.AgentJackIEC.prototype.availableLevels={Maze:0,Boss:1},JackDanger.AgentJackIEC.prototype.Maze=function(t){this.initialized=!1,this.main=t},JackDanger.AgentJackIEC.prototype.Maze.prototype={initLevel:function(){logInfo("Init Maze"),this.initialized=!0,this.backgroundLayer=this.main.add.group(),this.entityLayer=this.main.add.group(),this.foregroundLayer=this.main.add.group(),this.uiLayer=this.main.add.group(),this.hackLayer=this.main.add.group(),this.activeHack=null,this.borderOffsetX=112,this.setupScene(),this.ui=new this.UserInterface(this.main),this.jack=(new this.Jack).init(this.main.world.centerX-250,this.main.world.height-500,this.main),this.main.camera.follow(this.jack.sprite,Phaser.Camera.FOLLOW_TOPDOWN_TIGHT)},setupScene:function(){this.scene={},this.sceneData=this.main.cache.getJSON("maze-scene"),this.main.world.setBounds(0,0,this.sceneData.worldSize.x,this.sceneData.worldSize.y-400),this.main.physics.startSystem(Phaser.Physics.ARCADE),this.scene.background=this.main.add.sprite(this.main.world.centerX,this.main.world.height,"maze-bg-ground"),this.scene.background.anchor.setTo(.5,1),this.scene.background.scale.setTo(this.main.globalScale),this.backgroundLayer.add(this.scene.background),this.scene.middleGround=this.main.add.sprite(this.main.world.centerX,this.main.world.height,"maze-bg-middle"),this.scene.middleGround.anchor.setTo(.5,1),this.scene.middleGround.scale.setTo(this.main.globalScale),this.backgroundLayer.add(this.scene.middleGround),this.scene.foreground=this.main.add.sprite(this.main.world.centerX,this.main.world.height,"maze-bg-top"),this.scene.foreground.anchor.setTo(.5,1),this.scene.foreground.scale.setTo(this.main.globalScale),this.foregroundLayer.add(this.scene.foreground),this.debugAll=this.sceneData.debugAll,this.debugLowerY=this.sceneData.debugLowerY,this.enemies=[],this.currentSector=0,this.sectors=[0,550,1248,1638,2171],this.scene.gate={main:this.main,opened:!1,moving:!1,openGate:function(){if(!this.opened&&!this.moving){this.moving=!0;var t=this,i=this.gateDoorL,e=this.gateDoorR;this.closeGate;i.body.velocity.x=-25,e.body.velocity.x=25,setTimeout(function(){i.body.velocity.x=0,e.body.velocity.x=0,t.opened=!0,t.moving=!1},3500)}},closeGate:function(){if(this.opened&&!this.moving){this.moving=!0;var t=this,i=this.gateDoorL,e=this.gateDoorR;i.body.velocity.x=25,e.body.velocity.x=-25,setTimeout(function(){i.body.velocity.x=0,e.body.velocity.x=0,t.opened=!1,t.moving=!1},3500)}}},this.scene.gate.gateDoorL=this.main.add.sprite(0,0,"scenery","gate/gate-door"),this.main.physics.arcade.enable(this.scene.gate.gateDoorL),this.scene.gate.gateDoorL.anchor.setTo(0,0),this.scene.gate.gateDoorL.scale.setTo(this.main.globalScale),this.scene.gate.gateDoorL.position.setTo(this.main.world.centerX+16-this.scene.gate.gateDoorL.width,this.main.world.height-568-64),this.scene.gate.gateDoorL.gate=this.scene.gate,this.scene.gate.gateDoorL.body.immovable=!0,this.scene.gate.gateDoorL.body.sourceWidth=25,this.scene.gate.gateDoorL.body.sourceHeight=15,this.scene.gate.gateDoorL.deltaLowY=105,this.scene.gate.gateDoorL.depthUpdateSettings={shouldUpdateCollider:!0,sizePlayerUnderSprite:{width:25,height:15,offsetX:-100,offsetY:0},sizePlayerOverSprite:{width:25,height:7,offsetX:-100,offsetY:100}},this.entityLayer.add(this.scene.gate.gateDoorL),this.scene.gate.gateDoorR=this.main.add.sprite(0,0,"scenery","gate/gate-door"),this.main.physics.arcade.enable(this.scene.gate.gateDoorR),this.scene.gate.gateDoorR.anchor.setTo(0,0),this.scene.gate.gateDoorR.scale.setTo(-this.main.globalScale,this.main.globalScale),this.scene.gate.gateDoorR.position.setTo(this.main.world.centerX-16-this.scene.gate.gateDoorR.width,this.main.world.height-568-64),this.scene.gate.gateDoorR.gate=this.scene.gate,this.scene.gate.gateDoorR.body.immovable=!0,this.scene.gate.gateDoorR.body.sourceWidth=25,this.scene.gate.gateDoorR.body.sourceHeight=15,this.scene.gate.gateDoorR.deltaLowY=105,this.scene.gate.gateDoorR.depthUpdateSettings={sizePlayerUnderSprite:{width:25,height:15,offsetX:-225,offsetY:0},sizePlayerOverSprite:{width:25,height:7,offsetX:-225,offsetY:100}},this.entityLayer.add(this.scene.gate.gateDoorR),this.main.input.keyboard.addKey(Phaser.Keyboard.L).onDown.add(function(){this.opened?this.closeGate():this.openGate()},this.scene.gate),this.triggersWithPlayer.createTrigger(240,505,84,50,this.main,function(t){null==t.maze.activeHack&&(t.maze.activeHack=new t.maze.Hack(t,function(){t.maze.activeHack=null,t.maze.scene.gate.openGate()}))},function(){},!1);for(var t=0;t<this.sceneData.entities.length;t++){var i=this.sceneData.entities[t];if(void 0!=i.position||void 0!=i.sprite||void 0!=i.spritesheet||void 0!=i.sizePlayerUnderSprite||void 0!=i.sizePlayerOverSprite||void 0!=i.id){var e=this.main.add.sprite(i.position.x,this.main.game.world.height-i.position.y,i.spritesheet,i.sprite);this.main.physics.arcade.enable(e),e.id=i.id,e.scale.setTo(this.main.globalScale),e.anchor.setTo(i.anchor?i.anchor.x:0,i.anchor?i.anchor.y:0),e.body.immovable=i.immovable?!0:!1,e.depthUpdateSettings={sizePlayerUnderSprite:i.sizePlayerUnderSprite,sizePlayerOverSprite:i.sizePlayerOverSprite},void 0!=i.deltaLowY&&(e.deltaLowY=i.deltaLowY),void 0!=i.forcedZ&&(e.forcedZ=i.forcedZ),e.body.shouldDebug=i.shouldDebug,this.entityLayer.add(e)}}for(var t=0;t<this.sceneData.enemies.length;t++){var s=this.sceneData.enemies[t];s.y=this.main.world.height-s.y;var a=(new this.Enemy).init(s,this.main);this.enemies.push(a),this.entityLayer.add(a.sprite)}},triggersWithPlayer:{createTrigger:function(t,i,e,s,a,n,o,h){var r={getBounds:function(){return this.bounds},bounds:new Phaser.Rectangle(t,a.game.world.height-i,e,s),trigger:function(){this.used||(this.used=!0,this.main.maze.backgroundLayer.remove(this.sprite),this.sprite.destroy(),this.callback(this.main))},callback:n,main:a,update:o,used:!1,shouldDebug:h||!1,sprite:a.add.sprite(t+e/2,a.game.world.height-i+s/2,"hack-circles","trigger")};return r.sprite.sourceWidth=e,r.sprite.sourceHeight=s,r.sprite.anchor.setTo(.5,.5),r.sprite.tint=10605712,r.sprite.scale.setTo(1.5),a.maze.backgroundLayer.add(r.sprite),this.push(r),r},push:function(t){this.triggers.push(t)},remove:function(t){var i=this.triggers.indexOf(t);-1!=i&&this.triggers.splice(i,1)},forEach:function(t,i){if(0!=this.triggers.length)for(var e=0;e<this.triggers.length;e++){var s=this.triggers[e];s.used?(this.triggers.splice(e,1),e--):t(s,e,this.triggers,i)&&(e=this.triggers.length)}},triggers:[]},update:function(t){null!=this.activeHack?this.activeHack.update():(this.jack.update(t),this.updateEnemies(t,this.jack,this.currentSector),this.updateSector(),this.sortDepth(),this.debug(),this.jack.sprite.position.y<=112.5&&0==this.enemies.length&&onVictory())},updateEnemies:function(t,i,e){for(var s=0;s<this.enemies.length;s++){var a=this.enemies[s];a.dead?(this.enemies.splice(s,1),s--):this.enemies[s].update(t,i,e)}},updateSector:function(){var t=(this.sectors[this.currentSector],this.currentSector+1<this.sectors.length?this.sectors[this.currentSector+1]:-1);this.main.world.height-this.jack.sprite.position.y>=t&&-1!=t&&(this.currentSector++,logInfo(this.currentSector))},sortDepth:function(){this.entityLayer.customSort(function(t,i){var e=void 0!=t.deltaLowY?t.position.y+t.deltaLowY*(1-t.anchor.y):t.position.y+t.height*(1-t.anchor.y),s=void 0!=i.deltaLowY?i.position.y+i.deltaLowY*(1-i.anchor.y):i.position.y+i.height*(1-i.anchor.y);return this.debugLowerY&&(this.main.game.debug.geom(new Phaser.Rectangle(t.position.x,t.position.y+t.deltaLowY,10,10),"blue"),this.main.game.debug.geom(new Phaser.Rectangle(i.position.x,i.position.y+i.deltaLowY,10,10),"blue")),t.isPlayer?e=t.position.y+t.height/2-32:i.isPlayer&&(s=i.position.y+i.height/2-32),e>s?1:s>e?-1:0},this);for(var t=0;t<this.entityLayer.children.length;t++){var i=this.entityLayer.children[t];if(!i.isPlayer){var e=this.jack.sprite.position.y+this.jack.sprite.height/2-32,s=void 0!=i.deltaLowY?i.position.y+i.deltaLowY*(1-i.anchor.y):i.position.y+i.height*(1-i.anchor.y);e>s?i.body&&i.depthUpdateSettings&&i.body.setSize(i.depthUpdateSettings.sizePlayerUnderSprite.width,i.depthUpdateSettings.sizePlayerUnderSprite.height,this.main.maze.borderOffsetX+i.depthUpdateSettings.sizePlayerUnderSprite.offsetX,i.depthUpdateSettings.sizePlayerUnderSprite.offsetY):i.body&&i.depthUpdateSettings&&i.body.setSize(i.depthUpdateSettings.sizePlayerOverSprite.width,i.depthUpdateSettings.sizePlayerOverSprite.height,this.main.maze.borderOffsetX+i.depthUpdateSettings.sizePlayerOverSprite.offsetX,i.depthUpdateSettings.sizePlayerOverSprite.offsetY)}}},disposeLevel:function(){if(this.initialized){logInfo("Dispose Maze"),this.jack.sprite.destroy(),delete this.jack;for(var t=0;t<this.enemies.length;t++)this.enemies[t].sprite.destroy();delete this.enemies,this.backgroundLayer.destroy(),this.entityLayer.destroy(),this.foregroundLayer.destroy(),this.uiLayer.destroy(),this.hackLayer.destroy()}},debug:function(){}},JackDanger.AgentJackIEC.prototype.Maze.prototype.UserInterface=function(t){return this.enabled=!0,this.main=t,this.health=this.main.add.text(0,0,"HP: 99",{color:16777215}),this.health.fixedToCamera=!0,this.main.maze.uiLayer.add(this.health),this},JackDanger.AgentJackIEC.prototype.Maze.prototype.UserInterface.prototype={setHP:function(t){this.health.text="HP: "+t}},JackDanger.AgentJackIEC.prototype.Maze.prototype.Jack=function(){return this},JackDanger.AgentJackIEC.prototype.Maze.prototype.Jack.prototype={init:function(t,i,e){return this.sprite=e.add.sprite(t,i,"jack"),this.main=e,this.main.maze.entityLayer.add(this.sprite),this.main.physics.arcade.enable(this.sprite),this.sprite.scale.setTo(this.main.globalScale),this.sprite.anchor.setTo(.5,.5),this.sprite.body.collideWorldBounds=!0,this.sprite.body.sourceWidth=14,this.sprite.body.sourceHeight=20,this.sprite.isPlayer=!0,this.shooting=!1,this.lockMovement=!1,this.lockActions=!1,this.isHitting=!1,this.lastDirection=0,this.xHittingDistance={primary:50,secondary:50},this.yHittingDistance={primary:50,secondary:50},this.hitSpeed=50,this.fullSpeed=150,this.walkSpeed=this.fullSpeed,this.healthPoints=3,this.sound={hit:this.main.add.audio("jack-hit"),noHit:this.main.add.audio("jack-nohit")},this.sprite.animations.add("run-lr-idle",Phaser.Animation.generateFrameNames("run-lr-idle-",0,0,"",4),1,!0,!1),this.sprite.animations.add("run-lr",Phaser.Animation.generateFrameNames("run-lr-",0,16,"",4),40,!0,!1),this.sprite.animations.add("run-up-idle",Phaser.Animation.generateFrameNames("run-up-idle-",0,0,"",4),1,!0,!1),this.sprite.animations.add("run-up",Phaser.Animation.generateFrameNames("run-up-",0,17,"",4),40,!0,!1),this.sprite.animations.add("run-down-idle",Phaser.Animation.generateFrameNames("run-down-idle-",0,0,"",4),1,!0,!1),this.sprite.animations.add("run-down",Phaser.Animation.generateFrameNames("run-down-",0,17,"",4),40,!0,!1),this.sprite.animations.add("punch-lr",Phaser.Animation.generateFrameNames("punch-lr-",0,6,"",4),20,!1,!1),this.sprite.animations.add("punch-up",Phaser.Animation.generateFrameNames("punch-up-",0,5,"",4),20,!1,!1),this.sprite.animations.add("punch-down",Phaser.Animation.generateFrameNames("kick-down-",0,10,"",4),30,!1,!1),this.main.maze.ui.setHP(this.healthPoints),this},possibleDirections:{LEFT:0,RIGHT:1,UP:2,DOWN:3},update:function(t){this.updateInput(t),this.updateAnimation(t),this.updateCollision(t)},updateAnimation:function(t){this.walkAnimationBlocked||(0===this.sprite.body.velocity.y&&0===this.sprite.body.velocity.x?this.lastDirection==this.possibleDirections.LEFT?this.sprite.animations.play("run-lr-idle"):this.lastDirection==this.possibleDirections.RIGHT?this.sprite.animations.play("run-lr-idle"):this.lastDirection==this.possibleDirections.UP?this.sprite.animations.play("run-up-idle"):this.lastDirection==this.possibleDirections.DOWN&&this.sprite.animations.play("run-down-idle"):this.lastDirection==this.possibleDirections.LEFT?this.sprite.animations.play("run-lr"):this.lastDirection==this.possibleDirections.RIGHT?this.sprite.animations.play("run-lr"):this.lastDirection==this.possibleDirections.UP?this.sprite.animations.play("run-up"):this.lastDirection==this.possibleDirections.DOWN&&this.sprite.animations.play("run-down"))},updateShadow:function(t){},updateInput:function(t){this.sprite.body.velocity={x:0,y:0},this.lockMovement||(Pad.isDown(Pad.UP)?(this.sprite.body.velocity.y-=this.walkSpeed,this.lastDirection=this.possibleDirections.UP):Pad.isDown(Pad.DOWN)&&(this.sprite.body.velocity.y+=this.walkSpeed,this.lastDirection=this.possibleDirections.DOWN),Pad.isDown(Pad.LEFT)?(this.sprite.body.velocity.x-=this.walkSpeed,this.lastDirection=this.possibleDirections.LEFT):Pad.isDown(Pad.RIGHT)&&(this.sprite.body.velocity.x+=this.walkSpeed,this.lastDirection=this.possibleDirections.RIGHT),this.sprite.body.velocity.x>0&&this.sprite.scale.x<0?this.sprite.scale.x*=-1:this.sprite.body.velocity.x<0&&this.sprite.scale.x>0&&(this.sprite.scale.x*=-1),(this.lastDirection==this.possibleDirections.UP||this.lastDirection==this.possibleDirections.DOWN)&&this.sprite.scale.x<0&&(this.sprite.scale.x*=-1)),this.lockActions||Pad.justDown(Pad.SHOOT)&&!this.isHitting&&(logInfo("SHOOT"),this.onHit(this))},updateCollision:function(){for(var t=0;t<this.main.maze.entityLayer.children.length;t++){var i=this.main.maze.entityLayer.children[t];i.isPlayer||i.isEnemy||(this.main.physics.arcade.collide(this.sprite,i),(i.body&&i.body.shouldDebug||this.main.maze.debugAll)&&this.main.game.debug.body(i))}var e=Pad.justDown(Pad.JUMP),s=this;this.main.maze.triggersWithPlayer.forEach(function(t,i,a){var n=t.getBounds().contains(s.sprite.position.x,s.sprite.position.y+s.sprite.height/2-32);t.shouldDebug&&s.main.game.debug.geom(t.getBounds()),n&&t.update(),e&&!t.isUsed&&n&&t.trigger()},this.jack)},onHit:function(){this.walkAnimationBlocked=!0,this.lockActions=!0,this.isHitting=!0,this.walkSpeed=this.hitSpeed,this.lastDirection==this.possibleDirections.LEFT||this.lastDirection==this.possibleDirections.RIGHT?this.sprite.animations.play("punch-lr"):this.lastDirection==this.possibleDirections.UP?this.sprite.animations.play("punch-up"):this.lastDirection==this.possibleDirections.DOWN&&this.sprite.animations.play("punch-down"),this.sprite.animations.currentAnim.onComplete.add(this.onHitComplete,this);var t;switch(this.lastDirection){case this.possibleDirections.UP:t={x:-15,y:0,width:30,height:25};break;case this.possibleDirections.DOWN:t={x:-15,y:0,width:30,height:25};break;case this.possibleDirections.LEFT:t={x:-25,y:0,width:25,height:30};break;case this.possibleDirections.RIGHT:t={x:0,y:0,width:25,height:30};break;default:this.sound.noHit.play()}t.x+=this.sprite.position.x,t.y+=this.sprite.position.y-t.height/2;for(var i=0;i<this.main.maze.enemies.length;i++){var e=this.main.maze.enemies[i],s={x:e.sprite.position.x,y:e.sprite.position.y,width:e.sprite.body.width,height:e.sprite.body.height};s.x-=s.width/2,s.y-=s.height/2,t.x<s.x+s.width&&t.x+t.width>s.x&&t.y<s.y+s.height&&t.height+t.y>s.y?(this.sound.hit.play(),void 0!=e.onHitByJack&&e.onHitByJack(5)):this.sound.noHit.play()}},onHitComplete:function(){this.walkAnimationBlocked=!1,this.lockActions=!1,this.isHitting=!1,this.walkSpeed=this.fullSpeed},damage:function(){if(this.healthPoints--,this.main.maze.ui.setHP(this.healthPoints),this.healthPoints<=0)return void this.die();var t=this.main.add.sprite(this.sprite.position.x,this.sprite.position.y,"blood");t.anchor.setTo(.5),t.scale.setTo(this.main.globalScale),t.animations.add("splat",Phaser.Animation.generateFrameNames("blood-",0,5,"",4),7,!1,!1),t.animations.play("splat"),t.animations.currentAnim.onComplete.add(function(){this.kill()},t),this.main.maze.entityLayer.add(t),setTimeout(function(){},500)},die:function(){onLose()}},JackDanger.AgentJackIEC.prototype.Maze.prototype.Hack=function(t,i,e){this.main=t,this.callback=i,this.scope=e,this.active=!0,this.background=this.main.add.sprite(this.main.world.width/2,0,"hack-circles","hack-bg"),this.background.alpha=1,this.background.anchor.setTo(.5),this.background.scale.setTo(this.main.globalScale),this.background.position.setTo(this.main.world.width/2,this.background.height),this.main.maze.hackLayer.add(this.background),this.maxRad=2*Math.PI;var s=this.main.add.sprite(this.background.position.x,this.background.position.y,"hack-circles","circle-0-off");s.anchor.setTo(.5),s.scale.setTo(this.main.globalScale),s.rotation=Math.random()*this.maxRad,s.circleName="circle-0-",s.checkRot=function(){return this.rotation>=.04886316915294853&&this.rotation>=6.234322138?!0:!1},this.main.maze.hackLayer.add(s);var a=this.main.add.sprite(this.background.position.x,this.background.position.y,"hack-circles","circle-1-off");a.anchor.setTo(.5),a.scale.setTo(this.main.globalScale),a.rotation=Math.random()*this.maxRad,a.circleName="circle-1-",a.checkRot=function(){return this.rotation>=.04886316915294853&&this.rotation>=6.234322138?!0:!1},this.main.maze.hackLayer.add(a);var n=this.main.add.sprite(this.background.position.x,this.background.position.y,"hack-circles","circle-2-off");n.anchor.setTo(.5),n.scale.setTo(this.main.globalScale),n.rotation=Math.random()*this.maxRad,n.circleName="circle-2-",n.checkRot=function(){return this.rotation>=.04886316915294853&&this.rotation>=6.234322138?!0:!1},this.main.maze.hackLayer.add(n);var o=this.main.add.sprite(this.background.position.x,this.background.position.y,"hack-circles","circle-3-off");o.anchor.setTo(.5),o.scale.setTo(this.main.globalScale),o.rotation=Math.random()*this.maxRad,o.circleName="circle-3-",o.checkRot=function(){return this.rotation>=.04886316915294853&&this.rotation>=6.234322138?!0:!1},this.main.maze.hackLayer.add(o),this.circles=[s,a,n,o],this.selectedCircle=0,this.connectionDone=!1,this.previousTarget=this.main.camera.target,this.main.camera.unfollow(),this.main.camera.position=new Phaser.Point(this.background.position.x,this.background.position.y-this.background.height/3.5+1)},JackDanger.AgentJackIEC.prototype.Maze.prototype.Hack.prototype={update:function(){if(!this.connectionDone){Pad.justDown(Pad.DOWN)?(this.selectedCircle++,this.selectedCircle>=4&&(this.selectedCircle=3)):Pad.justDown(Pad.UP)&&(this.selectedCircle--,this.selectedCircle<0&&(this.selectedCircle=0));var t=this.circles[this.selectedCircle];Pad.isDown(Pad.LEFT)?t.rotation+=.0174533:Pad.isDown(Pad.RIGHT)&&(t.rotation-=.0174533);for(var i=!0,e=0;e<this.circles.length;e++){for(var t=this.circles[e];t.rotation>this.maxRad;)t.rotation=t.rotation-this.maxRad;for(;t.rotation<0;)t.rotation=this.maxRad-t.rotation;t.checkRot()?(t.frameName=t.circleName+"on",t.tint=16777215):(i=!1,t.frameName=t.circleName+"off",t.tint=16777215,e==this.selectedCircle&&(t.tint=14935011))}i&&this.endGame()}},endGame:function(){this.connectionDone=!0,this.background.frameName="hack-bg-done";var t=this;setTimeout(function(){t.dispose()},1e3)},dispose:function(){this.background.destroy();for(var t=0;t<this.circles.length;t++)this.circles[t].destroy();this.main.camera.follow(this.previousTarget,Phaser.Camera.FOLLOW_TOPDOWN_TIGHT),logInfo(this.callback),this.callback(this.scope)}},JackDanger.AgentJackIEC.prototype.Maze.prototype.Enemy=function(){return this},JackDanger.AgentJackIEC.prototype.Maze.prototype.Enemy.prototype={init:function(t,i){return this.sprite=i.add.sprite(t.x,t.y,t.spriteName),this.main=i,this.main.maze.entityLayer.add(this.sprite),this.main.physics.arcade.enable(this.sprite),this.sprite.scale.setTo(this.main.globalScale),this.sprite.anchor.setTo(.5,.5),this.sprite.body.collideWorldBounds=!0,this.sprite.body.setSize(15,20,0,0),this.sprite.isEnemy=!0,this.sprite.deltaLowY=50,this.walkAnimationBlocked=!1,this.hitSpeed=t.hitSpeed,this.fullSpeed=t.fullSpeed,this.walkSpeed=this.fullSpeed,this.maxHealth=t.maxHealth,this.health=this.maxHealth,this.attackStrength=t.attackStrength,this.sector=t.sector,this.hitting=!1,this.targetPosition=new Phaser.Point,this.sprite.animations.add("run-lr-idle",["run-lr-idle"],1,!0,!1),this.sprite.animations.add("run-lr",Phaser.Animation.generateFrameNames("run-lr-",1,7,"",4),8,!0,!1),this.sprite.animations.add("run-down",Phaser.Animation.generateFrameNames("run-down-",0,6,"",4),8,!0,!1),this.sprite.animations.add("run-up",Phaser.Animation.generateFrameNames("run-up-",0,5,"",4),8,!0,!1),this.sprite.animations.add("punch-lr",Phaser.Animation.generateFrameNames("punch-lr-",0,7,"",4),16,!1,!1),this.sprite.animations.add("punch-down",Phaser.Animation.generateFrameNames("punch-down-",0,4,"",4),10,!1,!1),this.sprite.animations.add("punch-up",Phaser.Animation.generateFrameNames("punch-up-",0,4,"",4),16,!1,!1),this.sprite.animations.play("run-lr-idle"),this},update:function(t,i,e){this.sector>e||(this.updateAI(t,i),this.updateAnimation(),this.updateCollision())},updateAI:function(t,i){this.targetPosition=i.sprite.position;var e=Phaser.Point.distance(this.targetPosition,this.sprite.position);if(e>30){var s=Phaser.Point.subtract(this.targetPosition,this.sprite.position).normalize();this.sprite.body.velocity=s.multiply(this.walkSpeed*t*1e3,this.walkSpeed*t*1e3)}else if(this.sprite.body.velocity=new Phaser.Point,!this.hitting){this.hitting=!0,this.walkAnimationBlocked=!0;var s=Phaser.Point.subtract(this.targetPosition,this.sprite.position).normalize();logInfo(s),Math.abs(s.y)<Math.abs(s.x)?this.sprite.animations.play("punch-lr"):s.y<0?this.sprite.animations.play("punch-up"):this.sprite.animations.play("punch-down");var a=i;this.sprite.animations.currentAnim.onComplete.add(function(){this.hitting=!1,this.walkAnimationBlocked=!1,Phaser.Point.distance(a.sprite.position,this.sprite.position)<=30&&this.health>0&&a.damage()},this)}},updateAnimation:function(){this.walkAnimationBlocked||(0===this.sprite.body.velocity.y&&0===this.sprite.body.velocity.x?this.sprite.animations.play("run-lr-idle"):Math.abs(this.sprite.body.velocity.y)<Math.abs(this.sprite.body.velocity.x)?this.sprite.animations.play("run-lr"):this.sprite.body.velocity.y<0?this.sprite.animations.play("run-up"):this.sprite.animations.play("run-down"),this.sprite.body.velocity.x>0&&this.sprite.scale.x<0?this.sprite.scale.x*=-1:this.sprite.body.velocity.x<0&&this.sprite.scale.x>0&&(this.sprite.scale.x*=-1))},updateCollision:function(){for(var t=0;t<this.main.maze.entityLayer.children.length;t++){var i=this.main.maze.entityLayer.children[t];i.isPlayer||this.main.physics.arcade.collide(this.sprite,i)}this.sprite.body&&this.sprite.body.shouldDebug&&this.main.game.debug.body(this.sprite)},onHitByJack:function(t){this.health-=t;var i=this.sprite;i.tint=16711680,setTimeout(function(){i.tint=16777215},500),this.health<=0&&this.die()},die:function(){this.dead=!0,this.sprite.destroy()}},JackDanger.AgentJackIEC.prototype.Boss=function(t){this.initialized=!1,this.game=t},JackDanger.AgentJackIEC.prototype.Boss.prototype={initLevel:function(){logInfo("Init Boss"),this.game.world.setBounds(0,0,800,450),this.running=!0,this.jack=this.game.add.sprite(this.game.world.width/2,this.game.world.height-100,"jack","run-lr-idle-0000"),this.jack.scale.setTo(this.game.globalScale),this.jack.anchor.setTo(.5,1),this.jack.animations.add("punch-lr",Phaser.Animation.generateFrameNames("punch-lr-",0,6,"",4),20,!1,!1),this.jack.animations.add("punch-up",Phaser.Animation.generateFrameNames("punch-up-",0,5,"",4),20,!1,!1),this.jack.animations.add("idle",["run-lr-idle-0000"],30,!1,!1),this.jack.health=100,this.jack.sound={hit:this.game.add.audio("jack-hit"),noHit:this.game.add.audio("jack-nohit")},this.jack.flip=function(t){(t&&this.scale.x>=0||!t&&this.scale.x<0)&&(this.scale.x*=-1)},this.jack.hit=function(t,i){for(var e=!0,s=0;s<i.length;s++){var a=i[s],n=a.isLeft?a.position.x>=300:a.position.x<=500;a.isLeft===t&&n&&(e=!1,this.sound.hit.play(!1),a.tint=16711680,setTimeout(function(){a.destroy()},50),i.splice(s,1),s=i.length)}e&&this.sound.noHit.play(!1)},this.enemies=[],this.enemiesCount=20,this.canPunch=!0,this.punchCooldown=0,this.spawnMachineTime=.5},update:function(t){this.updateInput(t),this.spawnMachine(t)},updateInput:function(t){this.canPunch||(this.punchCooldown-=t,this.punchCooldown<=0&&(this.canPunch=!0)),Pad.justDown(Pad.LEFT)&&this.canPunch?(this.jack.animations.play("punch-lr"),this.jack.flip(!0),this.jack.hit(!0,this.enemies),this.canPunch=!1,this.punchCooldown=.3):Pad.justDown(Pad.RIGHT)&&this.canPunch?(this.jack.animations.play("punch-lr"),this.jack.flip(!1),this.jack.hit(!1,this.enemies),this.canPunch=!1,this.punchCooldown=.3):this.jack.animations.currentAnim.isPlaying||this.jack.animations.play("idle",30,!0)},updateEnemies:function(){for(var t=0;t<this.enemies.length;t++)this.enemies[t].update()},spawnMachine:function(t){if(this.spawnMachineTime-=t,this.spawnMachineTime<=0){if(this.spawnMachineTime=.5,this.enemiesCount--<=0&&this.running)return void(this.enemies.length<=0&&(this.disposeLevel(),this.game.stop(),onVictory()));var i=Math.round(Math.random());0===i?this.spawnEnemy(!0):this.spawnEnemy(!1)}},spawnEnemy:function(t){var i=t?20:this.game.world.width-20,e=t?1:-1,s=this.game.add.sprite(i,this.game.world.height-100,"jack");s.scale.setTo(this.game.globalScale),s.scale.x*=e,s.anchor.setTo(.5,1),this.game.physics.arcade.enable(s),s.body.velocity.setTo(500*e,0),s.animations.add("punch-lr",Phaser.Animation.generateFrameNames("punch-lr-",0,10,"",4),30,!1,!1),s.isLeft=t,s.startedAttacking=!1,s.update=function(){this.isLeft&&this.position.x>=350?(this.body.velocity=new Phaser.Point,this.startAttacking()):!this.isLeft&&this.position.x<=450&&(this.body.velocity=new Phaser.Point,this.startAttacking())},s.startAttacking=function(){if(!this.startedAttacking){this.startedAttacking=!0;var t=this;this.attack(),setInterval(function(){t.attack()},400)}},s.attack=function(){this.animations.play("punch-lr",30,!1)},this.enemies.push(s)},disposeLevel:function(){this.initialized&&(this.running=!1,clearInterval(this.sMLoop),logInfo("Dispose Boss"))}},JackDanger.AgentJackIEC.prototype.ColliderEditor=function(t){this.isDrawing=!1,this.startingPoint=new Phaser.Point(0,0),this.endPoint=new Phaser.Point(0,0),this.game=t},JackDanger.AgentJackIEC.prototype.ColliderEditor.prototype={startColliderDrawing:function(){this.isDrawing||(this.isDrawing=!0,this.startingPoint=new Phaser.Point(this.game.input.worldX,this.game.input.worldY))},updateColliderDrawing:function(){this.isDrawing&&(this.endPoint=new Phaser.Point(this.game.input.worldX,this.game.input.worldY),this.game.debug.geom(new Phaser.Rectangle(this.startingPoint.x,this.startingPoint.y,this.endPoint.x-this.startingPoint.x,this.endPoint.y-this.startingPoint.y)))},endColliderDrawing:function(){if(this.isDrawing){this.isDrawing=!1,this.endPoint=new Phaser.Point(this.game.input.worldX,this.game.input.worldY);var t=this.startingPoint.x<this.endPoint.x?this.startingPoint.x:this.endPoint.x,i=this.startingPoint.y<this.endPoint.y?this.startingPoint.y:this.endPoint.y,e=this.startingPoint.x<this.endPoint.x?this.endPoint.x-this.startingPoint.x:this.startingPoint.x-this.endPoint.x,s=this.startingPoint.y<this.endPoint.y?this.endPoint.y-this.startingPoint.y:this.startingPoint.y-this.endPoint.y;logInfo(this.game),logInfo(JSON.stringify({x:t-113,y:this.game.world.height-i,width:e/this.game.main.globalScale,height:s/this.game.main.globalScale})),logInfo('{\n			"id": "name",\n			"spritesheet": "",\n			"sprite": "",\n			"position": {"x": '+(t-113)+', "y": '+(this.game.world.height-i)+'},\n			"anchor": {"x": 0, "y": 0},\n			"deltaLowY": 320,\n			"immovable": true,\n			"sizePlayerUnderSprite": {\n				"width": '+e/this.game.main.globalScale+',\n				"height": '+s/this.game.main.globalScale+',\n				"offsetX": 0,\n				"offsetY": 0\n			},\n			"sizePlayerOverSprite": {\n				"width": '+e/this.game.main.globalScale+',\n				"height": '+s/this.game.main.globalScale+',\n				"offsetX": 0,\n				"offsetY": 0\n			},\n			"shouldDebug": false\n		}')}}};